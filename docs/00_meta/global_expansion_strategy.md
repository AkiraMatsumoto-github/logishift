# LogiShift グローバル展開戦略

## 1. 概要
`en.logishift.net` というサブドメインで英語版LogiShiftを展開し、世界の物流市場をターゲットにします。これにより、SEO（地域ターゲティング）上の懸念を分離しつつ、統一されたブランドを維持します。

## 2. インフラアーキテクチャ

### 2.1 ドメイン戦略
- **日本版**: `logishift.net` (既存)
- **英語版**: `en.logishift.net` (新規)
  - **メリット**:
    - Googleはサブドメインを地域ターゲティングのために別個のエンティティとして扱います。
    - 必要に応じて異なるサーバー構成やテーマを適用しやすくなります。
    - デプロイ時にメインサイトを壊すリスクを低減できます。

### 2.2 WordPress構成
- **推奨**: **WordPressインスタンスの分離** (vs. マルチサイト)
  - 自動化ロジックが異なり、コンテンツデータベースも大きく重複しない（ターゲットごとに記事が異なる）ため、`en.logishift.net` 用に軽量なWPを別途インストールする方が管理もセキュリティも容易です。
  - **認証情報**:
    - `logishift.net`: `.env` の `WP_URL`, `WP_USER`, `WP_APP_PASSWORD` を使用。
    - `en.logishift.net`: 新たに `WP_EN_URL`, `WP_EN_USER`, `WP_EN_PASSWORD` を使用。

## 3. 自動化パイプラインの設計

### 3.1 「分割 vs 設定化」の判断
`pipeline.py` を `pipeline_jp.py` と `pipeline_en.py` に複製して分割する（保守負債を生む）のではなく、既存のパイプラインを **設定駆動（Configuration Driven）** にリファクタリングすることを推奨します。

### 3.2 具体的なリファクタリングポイント
1.  **`wp_client.py`**:
    - 認証情報を `os.getenv` でハードコードするのではなく、`__init__` で引数として受け取るように変更します。
    - 呼び出し元がターゲットサイトの認証情報を注入できるようにします。

2.  **`gemini_client.py`**:
    - `language` パラメータ（デフォルト: `ja`）を追加します。
    - プロンプトを辞書構造で管理します：
      ```python
      PROMPTS = {
          "ja": { ...既存の日本語プロンプト... },
          "en": { ...新規の英語プロンプト... }
      }
      ```
    - 英語ペルソナ用のシステム指示を設定します（例: "You are a logistics expert writing for a global audience..."）。

3.  **`pipeline.py`**:
    - コマンドライン引数 `--target [jp|en]` を追加します。
    - ターゲットに基づいて以下を切り替えます：
      - 適切なWP認証情報の読み込み。
      - ソースタイプの選択（例: EN向けには米国/EUのソースを優先し英語で要約する、あるいは独自の日本の物流ニュースを英語に翻訳する）。
      - 生成ステップに `language='en'` フラグを渡す。

### 3.3 英語版サイトのコンテンツ戦略
| コンテンツソース | 日本版（既存） | 英語版（新規） |
| :--- | :--- | :--- |
| **海外ニュース (TechCrunch, WSJ 等)** | 日本語に翻訳・要約 | 英語で要約（原文言語のまま） |
| **国内ニュース (LNews 等)** | 日本語で要約 | **勝機あり**: 独自の日本市場の洞察を英語に翻訳（日本市場に関心のある海外読者に高付加価値） |

### 3.4 CI/CD戦略（GitHub Actions）
ユーザーのご提案通り、**日本語用と英語用でYAMLファイルを2つに分割**する方式を採用します。
- **`article-pipeline-jp.yml`**: 既存のワークフロー。`--target jp` （またはデフォルト）で実行。
- **`article-pipeline-en.yml`**: 新規作成。`--target en` で実行。

### 3.5 リポジトリ・テーマ管理戦略
**【決定案：シングルリポジトリ・マルチテーマ構成】**
ユーザーのご提案通り、リポジトリは分割せず、1つのリポジトリ内でテーマディレクトリを分けます。

- **ディレクトリ構成**:
  - `themes/logishift` -> 日本語版 (既存)
  - `themes/logishift_en` -> 英語版 (新規)
- **管理方法**:
  - 1つのリポジトリで両方の言語のテーマを管理します。
  - GitHub Actionsで、変更があったテーマのみをそれぞれのサーバー（WP）にデプロイします。
- **デプロイフロー**:
  - `deploy-theme-jp.yml` (旧 deploy-theme.yml): `themes/logishift/**` の変更を検知 -> `logishift.net` へデプロイ
  - `deploy-theme-en.yml`: `themes/logishift_en/**` の変更を検知 -> `en.logishift.net` へデプロイ

**メリット**:
- 自動化ツール（Bot）とテーマのコードが一元管理でき、長期的なメンテナンス性が高い。
- 言語ごとのフロントエンド変更（英語版独自の微調整など）が出ても、他方のテーマに影響を与えない。
- 別リポジトリ管理の手間（同期漏れなど）がない。

## 4. 実装フェーズ

### Phase 1: テーマ準備
- `themes/logishift` を `themes/logishift_en` にコピー。
- `style.css` の Theme Name を変更。
- GitHub Actions の設定ファイルを分割。

### Phase 2: 自動化ロジックの改修
- `wp_client.py` と `gemini_client.py` を設定駆動型にアップデート。
- 既存の日本語パイプラインが100%正常に動作することを検証。
- 英語ロジック（プロンプト等）の実装。

### Phase 3: インフラ連携
- `en.logishift.net` のWordPressセットアップ（ユーザー実施）。
- 新サイト用のAPI認証情報を発行し、GitHub Secretsに登録。

### Phase 4: ローンチ
- パイプラインの手動テストと自動化スケジュールの設定。
